<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CHRIS-ONTOLOGY 3D ðŸ¦‡</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, monospace;
            background: #000;
            color: #fff;
            overflow: hidden;
        }
        
        #canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(ellipse at center, #0a0a1a 0%, #000 100%);
        }
        
        .ui-layer {
            position: fixed;
            pointer-events: none;
            width: 100%;
            height: 100%;
            z-index: 10;
        }
        
        .header {
            position: absolute;
            top: 20px;
            left: 40px;
            pointer-events: auto;
        }
        
        .header h1 {
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(90deg, #ff6b35, #f7931e, #ff6b35);
            background-size: 200% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: shine 3s linear infinite;
            text-transform: uppercase;
            letter-spacing: 3px;
        }
        
        @keyframes shine {
            to { background-position: 200% center; }
        }
        
        .header .subtitle {
            font-size: 12px;
            color: #58a6ff;
            margin-top: 5px;
            letter-spacing: 2px;
        }
        
        .stats-panel {
            position: absolute;
            top: 20px;
            right: 40px;
            background: rgba(13, 17, 23, 0.9);
            border: 1px solid #30363d;
            border-radius: 12px;
            padding: 20px;
            pointer-events: auto;
            backdrop-filter: blur(10px);
            min-width: 200px;
        }
        
        .stat-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #21262d;
        }
        
        .stat-row:last-child {
            border-bottom: none;
        }
        
        .stat-label {
            font-size: 11px;
            color: #8b949e;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .stat-value {
            font-size: 18px;
            font-weight: 700;
            color: #ff6b35;
        }
        
        .controls {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 15px;
            pointer-events: auto;
        }
        
        .btn {
            background: rgba(13, 17, 23, 0.9);
            border: 1px solid #30363d;
            color: #fff;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 2px;
            transition: all 0.3s;
            backdrop-filter: blur(10px);
        }
        
        .btn:hover {
            border-color: #ff6b35;
            box-shadow: 0 0 20px rgba(255, 107, 53, 0.3);
        }
        
        .btn.active {
            background: linear-gradient(135deg, #ff6b35, #f7931e);
            border-color: transparent;
        }
        
        .detail-card {
            position: absolute;
            bottom: 30px;
            right: 40px;
            background: rgba(13, 17, 23, 0.95);
            border: 1px solid #30363d;
            border-radius: 16px;
            padding: 25px;
            pointer-events: auto;
            backdrop-filter: blur(20px);
            max-width: 320px;
            transform: translateX(400px);
            transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
        }
        
        .detail-card.show {
            transform: translateX(0);
        }
        
        .detail-card h3 {
            font-size: 20px;
            margin-bottom: 15px;
            color: #ff6b35;
        }
        
        .detail-card .type-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 15px;
        }
        
        .detail-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #21262d;
            font-size: 13px;
        }
        
        .detail-item:last-child {
            border-bottom: none;
        }
        
        .detail-key {
            color: #8b949e;
        }
        
        .detail-value {
            color: #fff;
            font-weight: 500;
        }
        
        .legend {
            position: absolute;
            bottom: 30px;
            left: 40px;
            background: rgba(13, 17, 23, 0.9);
            border: 1px solid #30363d;
            border-radius: 12px;
            padding: 20px;
            pointer-events: auto;
            backdrop-filter: blur(10px);
        }
        
        .legend h4 {
            font-size: 12px;
            color: #8b949e;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
            font-size: 12px;
        }
        
        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }
        
        .loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 14px;
            color: #ff6b35;
            letter-spacing: 3px;
            z-index: 100;
        }
        
        .loading::after {
            content: '';
            animation: dots 1.5s infinite;
        }
        
        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60%, 100% { content: '...'; }
        }
    </style>
</head>
<body>
    <div class="loading" id="loading">INITIALIZING ONTOLOGY</div>
    
    <div id="canvas-container"></div>
    
    <div class="ui-layer">
        <div class="header">
            <h1>ðŸ¦‡ CHRIS-ONTOLOGY</h1>
            <div class="subtitle">NEURAL NETWORK VISUALIZATION v3D</div>
        </div>
        
        <div class="stats-panel">
            <div class="stat-row">
                <span class="stat-label">Nodes</span>
                <span class="stat-value">28</span>
            </div>
            <div class="stat-row">
                <span class="stat-label">Connections</span>
                <span class="stat-value">27</span>
            </div>
            <div class="stat-row">
                <span class="stat-label">Depth</span>
                <span class="stat-value">4</span>
            </div>
            <div class="stat-row">
                <span class="stat-label">Status</span>
                <span class="stat-value" style="color: #7ee787;">ACTIVE</span>
            </div>
        </div>
        
        <div class="controls">
            <button class="btn" onclick="resetView()">Reset View</button>
            <button class="btn active" onclick="toggleRotation()" id="rotateBtn">Auto Rotate</button>
            <button class="btn" onclick="explodeView()">Explode</button>
        </div>
        
        <div class="legend">
            <h4>Entity Types</h4>
            <div class="legend-item">
                <div class="legend-color" style="background: #ff6b35;"></div>
                <span>Person (Chris)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #58a6ff;"></div>
                <span>Companies</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #7ee787;"></div>
                <span>Employees (15)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #f0883e;"></div>
                <span>Data Sources</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #a371f7;"></div>
                <span>Investment</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #79c0ff;"></div>
                <span>Partners</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #ff7b72;"></div>
                <span>Trips</span>
            </div>
        </div>
        
        <div class="detail-card" id="detailCard">
            <h3 id="detailTitle">Entity Name</h3>
            <span class="type-badge" id="detailType">TYPE</span>
            <div id="detailContent"></div>
        </div>
    </div>

    <script>
        // Ontology Data
        const ontologyData = {
            nodes: [
                { id: "chris", name: "Chris", type: "person", size: 3, 
                  details: { role: "Founder/CEO", timezone: "Asia/Seoul", work: "14:00-18:00", sleep: "01:00-02:00" }},
                { id: "roturn", name: "Roturn", type: "company", size: 2.5,
                  details: { type: "LPG bifuel", status: "active", focus: "WFS/Prins ê°œë°œ" }},
                { id: "koreacryo", name: "KoreaCryo", type: "company", size: 2.5,
                  details: { type: "ì´ˆì €ì˜¨ ìž¥ë¹„", status: "active", focus: "ì›¹ì‚¬ì´íŠ¸ ë¦¬ë‰´ì–¼" }},
                { id: "emp1", name: "ì´íšŒëž€", type: "employee", size: 1.2,
                  details: { dept: "ê²½ì˜ì§€ì›íŒ€", position: "ëŒ€í‘œì´ì‚¬", email: "hrlee@koreacryo.com" }},
                { id: "emp2", name: "ì •ì„ í¬", type: "employee", size: 1.2,
                  details: { dept: "ì˜ì—…íŒ€", position: "ì±…ìž„ë§¤ë‹ˆì €", email: "sjeong@koreacryo.com" }},
                { id: "emp3", name: "ê°•ëŒ€ì¼", type: "employee", size: 1.2,
                  details: { dept: "ì˜ì—…íŒ€", position: "ì±…ìž„ë§¤ë‹ˆì €", email: "" }},
                { id: "emp4", name: "ì´í˜œìš©", type: "employee", size: 1.2,
                  details: { dept: "ê²½ì˜ì§€ì›íŒ€", position: "ì±…ìž„ë§¤ë‹ˆì €", email: "hylee@koreacryo.com" }},
                { id: "emp5", name: "ê¹€ê²½ì„¸", type: "employee", size: 1.2,
                  details: { dept: "ê²½ì˜ì§€ì›íŒ€", position: "ì±…ìž„ë§¤ë‹ˆì €", email: "sskim@koreacryo.com" }},
                { id: "emp6", name: "ì •ì§„ìˆ™", type: "employee", size: 1.2,
                  details: { dept: "ê²½ì˜ì§€ì›íŒ€", position: "ë§¤ë‹ˆì €", email: "jsjeong@koreacryo.com" }},
                { id: "emp7", name: "ê¹€ê´‘ìˆ˜", type: "employee", size: 1.2,
                  details: { dept: "ê¸°ìˆ ì˜ì—…íŒ€", position: "ì±…ìž„ë§¤ë‹ˆì €", email: "kskim@koreacryo.com" }},
                { id: "emp8", name: "í•œìŠ¹í•œ", type: "employee", size: 1.2,
                  details: { dept: "ê¸°ìˆ ì˜ì—…íŒ€", position: "ë§¤ë‹ˆì €", email: "shhan@koreacryo.com" }},
                { id: "emp9", name: "ê°•ì •ê¸°", type: "employee", size: 1.2,
                  details: { dept: "ê¸°ìˆ ì˜ì—…íŒ€", position: "ë§¤ë‹ˆì €", email: "jkkang@koreacryo.com" }},
                { id: "emp10", name: "ê¶Œì˜ê±´", type: "employee", size: 1.2,
                  details: { dept: "ê¸°ìˆ ì˜ì—…íŒ€", position: "ë§¤ë‹ˆì €", email: "ygkwon@koreacryo.com" }},
                { id: "emp11", name: "ì—„íƒœì¤€", type: "employee", size: 1.2,
                  details: { dept: "ê¸°ìˆ ì˜ì—…íŒ€", position: "ë§¤ë‹ˆì €", email: "tjeom@koreacryo.com" }},
                { id: "emp12", name: "ì´ì˜ë™", type: "employee", size: 1.2,
                  details: { dept: "ê¸°ìˆ ì˜ì—…íŒ€", position: "ë§¤ë‹ˆì €", email: "ydlee@koreacryo.com" }},
                { id: "emp13", name: "ì •ì„±ìš±", type: "employee", size: 1.2,
                  details: { dept: "ê¸°ìˆ ì˜ì—…íŒ€", position: "ë§¤ë‹ˆì €", email: "swjeong@koreacryo.com" }},
                { id: "emp14", name: "ë°•ì°½ìˆ˜", type: "employee", size: 1.2,
                  details: { dept: "ê¸°ìˆ ì˜ì—…íŒ€", position: "ë§¤ë‹ˆì €", email: "csbak@koreacryo.com" }},
                { id: "emp15", name: "ê¹€í•´ì„±", type: "employee", size: 1.2,
                  details: { dept: "ê¸°ìˆ ì˜ì—…íŒ€", position: "ë§¤ë‹ˆì €", email: "hskim@koreacryo.com" }},
                { id: "calendar", name: "Google Calendar", type: "source", size: 1.5,
                  details: { provider: "google", status: "connected" }},
                { id: "gmail", name: "Gmail", type: "source", size: 1.5,
                  details: { provider: "gmail", emails: 1803, analyzed: 1044 }},
                { id: "ecount", name: "eCount ERP", type: "source", size: 1.5,
                  details: { provider: "ecount", code: "82532" }},
                { id: "drive", name: "Google Drive", type: "source", size: 1.5,
                  details: { provider: "google_drive" }},
                { id: "investment", name: "Portfolio", type: "investment", size: 1.8,
                  details: { value: "â‚©562M", gain: "+39.26%", style: "ì„±ìž¥ì£¼/í…ë°°ê±°" }},
                { id: "luxfer", name: "Luxfer", type: "partner", size: 1.3,
                  details: { type: "Hydrogen Valves", priority: "HIGH" }},
                { id: "taylor", name: "Taylor-Wharton", type: "partner", size: 1.3,
                  details: { type: "Cryogenic Equipment" }},
                { id: "holy", name: "Holy Cryogenics", type: "partner", size: 1.3,
                  details: { type: "Vacuum Pipeline" }},
                { id: "icbio", name: "ICBiomedical", type: "partner", size: 1.3,
                  details: { type: "Medical Cryo" }},
                { id: "thailand", name: "Thailand Trip", type: "trip", size: 1.6,
                  details: { dates: "2026-02-17 ~ 02-23", location: "Mae Sot" }},
            ],
            links: [
                { source: "chris", target: "roturn", value: 10 },
                { source: "chris", target: "koreacryo", value: 10 },
                { source: "chris", target: "investment", value: 8 },
                { source: "chris", target: "thailand", value: 5 },
                { source: "koreacryo", target: "emp1", value: 3 },
                { source: "koreacryo", target: "emp2", value: 3 },
                { source: "koreacryo", target: "emp3", value: 3 },
                { source: "koreacryo", target: "emp4", value: 3 },
                { source: "koreacryo", target: "emp5", value: 3 },
                { source: "koreacryo", target: "emp6", value: 3 },
                { source: "koreacryo", target: "emp7", value: 3 },
                { source: "koreacryo", target: "emp8", value: 3 },
                { source: "koreacryo", target: "emp9", value: 3 },
                { source: "koreacryo", target: "emp10", value: 3 },
                { source: "koreacryo", target: "emp11", value: 3 },
                { source: "koreacryo", target: "emp12", value: 3 },
                { source: "koreacryo", target: "emp13", value: 3 },
                { source: "koreacryo", target: "emp14", value: 3 },
                { source: "koreacryo", target: "emp15", value: 3 },
                { source: "koreacryo", target: "calendar", value: 4 },
                { source: "koreacryo", target: "gmail", value: 4 },
                { source: "koreacryo", target: "ecount", value: 4 },
                { source: "koreacryo", target: "drive", value: 4 },
                { source: "koreacryo", target: "luxfer", value: 5 },
                { source: "koreacryo", target: "taylor", value: 5 },
                { source: "koreacryo", target: "holy", value: 4 },
                { source: "koreacryo", target: "icbio", value: 3 },
            ]
        };

        const colors = {
            person: 0xff6b35,
            company: 0x58a6ff,
            employee: 0x7ee787,
            source: 0xf0883e,
            investment: 0xa371f7,
            partner: 0x79c0ff,
            trip: 0xff7b72
        };

        // Three.js Setup
        const scene = new THREE.Scene();
        scene.fog = new THREE.FogExp2(0x000000, 0.02);
        
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(0, 0, 25);
        
        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        document.getElementById('canvas-container').appendChild(renderer.domElement);
        
        // Controls
        const controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.05;
        controls.autoRotate = true;
        controls.autoRotateSpeed = 0.5;
        
        // Lighting
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.3);
        scene.add(ambientLight);
        
        const pointLight = new THREE.PointLight(0xff6b35, 1, 100);
        pointLight.position.set(10, 10, 10);
        scene.add(pointLight);
        
        const pointLight2 = new THREE.PointLight(0x58a6ff, 1, 100);
        pointLight2.position.set(-10, -10, 10);
        scene.add(pointLight2);
        
        // Node Meshes
        const nodeMeshes = {};
        const nodesGroup = new THREE.Group();
        scene.add(nodesGroup);
        
        // Create nodes with glow effect
        ontologyData.nodes.forEach(node => {
            const geometry = new THREE.SphereGeometry(node.size * 0.4, 32, 32);
            const material = new THREE.MeshPhongMaterial({
                color: colors[node.type],
                emissive: colors[node.type],
                emissiveIntensity: 0.3,
                shininess: 100
            });
            const mesh = new THREE.Mesh(geometry, material);
            
            // Glow effect (outer ring)
            const glowGeometry = new THREE.SphereGeometry(node.size * 0.6, 32, 32);
            const glowMaterial = new THREE.MeshBasicMaterial({
                color: colors[node.type],
                transparent: true,
                opacity: 0.15
            });
            const glow = new THREE.Mesh(glowGeometry, glowMaterial);
            mesh.add(glow);
            
            // Random initial position in sphere
            const phi = Math.random() * Math.PI * 2;
            const theta = Math.random() * Math.PI;
            const radius = 5 + Math.random() * 10;
            mesh.position.x = radius * Math.sin(theta) * Math.cos(phi);
            mesh.position.y = radius * Math.sin(theta) * Math.sin(phi);
            mesh.position.z = radius * Math.cos(theta);
            
            mesh.userData = node;
            nodeMeshes[node.id] = mesh;
            nodesGroup.add(mesh);
        });
        
        // Links
        const linksGroup = new THREE.Group();
        scene.add(linksGroup);
        const linkLines = [];
        
        ontologyData.links.forEach(link => {
            const sourceNode = nodeMeshes[link.source];
            const targetNode = nodeMeshes[link.target];
            
            if (sourceNode && targetNode) {
                const geometry = new THREE.BufferGeometry().setFromPoints([
                    sourceNode.position,
                    targetNode.position
                ]);
                const material = new THREE.LineBasicMaterial({
                    color: 0x30363d,
                    transparent: true,
                    opacity: 0.4
                });
                const line = new THREE.Line(geometry, material);
                line.userData = { source: sourceNode, target: targetNode };
                linkLines.push(line);
                linksGroup.add(line);
            }
        });
        
        // Particle system for background
        const particleGeometry = new THREE.BufferGeometry();
        const particleCount = 500;
        const positions = new Float32Array(particleCount * 3);
        
        for (let i = 0; i < particleCount * 3; i++) {
            positions[i] = (Math.random() - 0.5) * 100;
        }
        
        particleGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
        const particleMaterial = new THREE.PointsMaterial({
            color: 0x58a6ff,
            size: 0.1,
            transparent: true,
            opacity: 0.5
        });
        const particles = new THREE.Points(particleGeometry, particleMaterial);
        scene.add(particles);
        
        // Simple force-directed layout
        function applyForces() {
            const nodes = Object.values(nodeMeshes);
            const centerStrength = 0.02;
            const repulsionStrength = 50;
            const linkStrength = 0.1;
            
            // Repulsion between all nodes
            for (let i = 0; i < nodes.length; i++) {
                for (let j = i + 1; j < nodes.length; j++) {
                    const dx = nodes[i].position.x - nodes[j].position.x;
                    const dy = nodes[i].position.y - nodes[j].position.y;
                    const dz = nodes[i].position.z - nodes[j].position.z;
                    const dist = Math.sqrt(dx * dx + dy * dy + dz * dz) || 1;
                    
                    const force = repulsionStrength / (dist * dist);
                    const fx = (dx / dist) * force;
                    const fy = (dy / dist) * force;
                    const fz = (dz / dist) * force;
                    
                    nodes[i].position.x += fx;
                    nodes[i].position.y += fy;
                    nodes[i].position.z += fz;
                    nodes[j].position.x -= fx;
                    nodes[j].position.y -= fy;
                    nodes[j].position.z -= fz;
                }
            }
            
            // Spring forces for links
            ontologyData.links.forEach(link => {
                const source = nodeMeshes[link.source];
                const target = nodeMeshes[link.target];
                if (source && target) {
                    const dx = target.position.x - source.position.x;
                    const dy = target.position.y - source.position.y;
                    const dz = target.position.z - source.position.z;
                    const dist = Math.sqrt(dx * dx + dy * dy + dz * dz) || 1;
                    
                    const targetDist = 5 + link.value * 0.5;
                    const force = (dist - targetDist) * linkStrength;
                    const fx = (dx / dist) * force;
                    const fy = (dy / dist) * force;
                    const fz = (dz / dist) * force;
                    
                    source.position.x += fx;
                    source.position.y += fy;
                    source.position.z += fz;
                    target.position.x -= fx;
                    target.position.y -= fy;
                    target.position.z -= fz;
                }
            });
            
            // Pull to center
            nodes.forEach(node => {
                node.position.x *= (1 - centerStrength);
                node.position.y *= (1 - centerStrength);
                node.position.z *= (1 - centerStrength);
            });
        }
        
        // Update link positions
        function updateLinks() {
            linkLines.forEach(line => {
                const positions = line.geometry.attributes.position.array;
                positions[0] = line.userData.source.position.x;
                positions[1] = line.userData.source.position.y;
                positions[2] = line.userData.source.position.z;
                positions[3] = line.userData.target.position.x;
                positions[4] = line.userData.target.position.y;
                positions[5] = line.userData.target.position.z;
                line.geometry.attributes.position.needsUpdate = true;
            });
        }
        
        // Raycaster for click detection
        const raycaster = new THREE.Raycaster();
        const mouse = new THREE.Vector2();
        
        function onMouseClick(event) {
            mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
            mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
            
            raycaster.setFromCamera(mouse, camera);
            const intersects = raycaster.intersectObjects(Object.values(nodeMeshes));
            
            if (intersects.length > 0) {
                const node = intersects[0].object.userData;
                showDetails(node);
                
                // Highlight animation
                gsap.to(intersects[0].object.scale, {
                    x: 1.5, y: 1.5, z: 1.5,
                    duration: 0.3,
                    yoyo: true,
                    repeat: 1
                });
            }
        }
        
        window.addEventListener('click', onMouseClick);
        
        // Show details panel
        function showDetails(node) {
            const card = document.getElementById('detailCard');
            const title = document.getElementById('detailTitle');
            const type = document.getElementById('detailType');
            const content = document.getElementById('detailContent');
            
            title.textContent = node.name;
            type.textContent = node.type.toUpperCase();
            type.style.background = '#' + colors[node.type].toString(16).padStart(6, '0');
            type.style.color = '#000';
            
            let html = '';
            for (const [key, value] of Object.entries(node.details)) {
                html += `<div class="detail-item"><span class="detail-key">${key}</span><span class="detail-value">${Array.isArray(value) ? value.join(', ') : value}</span></div>`;
            }
            content.innerHTML = html;
            
            card.classList.add('show');
        }
        
        // Controls
        let isExploded = false;
        
        function resetView() {
            gsap.to(camera.position, {
                x: 0, y: 0, z: 25,
                duration: 1.5,
                ease: "power2.inOut"
            });
            controls.target.set(0, 0, 0);
        }
        
        function toggleRotation() {
            controls.autoRotate = !controls.autoRotate;
            document.getElementById('rotateBtn').classList.toggle('active');
        }
        
        function explodeView() {
            isExploded = !isExploded;
            const multiplier = isExploded ? 2 : 1;
            
            Object.values(nodeMeshes).forEach(mesh => {
                gsap.to(mesh.position, {
                    x: mesh.position.x * multiplier,
                    y: mesh.position.y * multiplier,
                    z: mesh.position.z * multiplier,
                    duration: 1,
                    ease: "power2.out"
                });
            });
        }
        
        // Resize handler
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
        
        // Animation loop
        let frame = 0;
        function animate() {
            requestAnimationFrame(animate);
            
            if (frame < 300) {
                applyForces();
            }
            updateLinks();
            
            controls.update();
            
            // Rotate particles
            particles.rotation.y += 0.0005;
            particles.rotation.x += 0.0002;
            
            renderer.render(scene, camera);
            frame++;
        }
        
        // Hide loading
        setTimeout(() => {
            document.getElementById('loading').style.display = 'none';
        }, 1500);
        
        animate();
    </script>
</body>
</html>
